{
	"name": "SQL script 8",
	"properties": {
		"content": {
			"query": "DROP TABLE [gold].[customer_dim];\n\nCREATE TABLE [gold].[customer_dim]\n(\n customer_id varchar(50),\n member_id VARCHAR(50),\n first_name varchar(50),\n last_name varchar(50),\n prm_status varchar(10),\n age INT,\n state varchar(30),\n country varchar(30)\n)\nWITH\n(\n    DISTRIBUTION = HASH(customer_id),\n    CLUSTERED COLUMNSTORE INDEX\n)\nGO\n\n\n\nCREATE TABLE [gold].[investor_dim]\n(\n investor_id varchar(30),\n loan_funded_amount INT,\n investor_type varchar(50),\n age INT,\n state varchar(30),\n country varchar(30)\n)\nWITH\n(\n    DISTRIBUTION = HASH (investor_id),\n    CLUSTERED COLUMNSTORE INDEX\n)\nGO\n\nDROP TABLE [gold].[loan_details_dim]\nCREATE TABLE [gold].[loan_details_dim] (\n\tloan_id varchar(30),\n\tmember_id VARCHAR(50),\n\tloan_amnt INT, \n\tfunded_amnt int, \n\tterm VARCHAR(30), \n\tint_rate varchar(30), \n\tinstallment DECIMAL(18, 2), \n\tissue_d VARCHAR(50), \n\tloan_status VARCHAR(50), \n\tpurpose VARCHAR(50), \n\ttitle VARCHAR(50), \n\tdisbursement_method VARCHAR(50)\n)\nWITH\n(\n    DISTRIBUTION = HASH (loan_id),\n    CLUSTERED COLUMNSTORE INDEX\n)\nGO\n\n\nDROP TABLE [gold].[account_details_dim]\n\nCREATE TABLE [gold].[account_details_dim] (\n\taccount_id  VARCHAR(50),\n\tmember_id VARCHAR(50),\n\tgrade VARCHAR(50), \n\tsub_grade VARCHAR(50), \n\temp_title VARCHAR(50) , \n\temp_length VARCHAR(50), \n\thome_ownership VARCHAR(50), \n\tannual_inc INT, \n\tverification_status VARCHAR(50), \n\ttotal_acc INT, \n\tapplication_type VARCHAR(50), \n\tannual_inc_joint INT,  \n\tverification_status_joint VARCHAR(50), \n\ttot_hi_cred_lim INT\n)\nWITH\n(\n    DISTRIBUTION = HASH (account_id),\n    CLUSTERED COLUMNSTORE INDEX\n)\nGO\n\nCREATE TABLE [gold].[Fact_table] (\n\tid  INT,\n\tloan_id VARCHAR(50) NOT NULL, \n\tcustomer_id VARCHAR(50) NOT NULL, \n\taccount_id VARCHAR(50) NOT NULL, \n\ttransaction_id VARCHAR(50) NOT NULL, \n\tdefaulter_id VARCHAR(50) NOT NULL, \n\tinvestor_id VARCHAR(50) NOT NULL, \n\tloan_amnt INT\n)\nWITH\n(\n    DISTRIBUTION = HASH (id),\n    CLUSTERED COLUMNSTORE INDEX\n)\nGO\n\n |-- transaction_id: string (nullable = false)\n |-- funded_amnt_inv: integer (nullable = true)\n |-- installment: decimal(18,2) (nullable = true)\n |-- total_pymnt: decimal(18,2) (nullable = true)\n |-- last_pymnt_d: string (nullable = true)\n |-- last_pymnt_amnt: decimal(18,2) (nullable = true)\n |-- next_pymnt_d: string (nullable = true)\n |-- disbursement_method: string (nullable = true)\n\n\nDROP TABLE [gold].[Payment_Details_Dim]\nCREATE TABLE [gold].[Payment_Details_Dim] (\n\ttransaction_id  VARCHAR(50) NOT NULL,\n\tmember_id VARCHAR(50) ,\n\tfunded_amnt_inv INT, \n\tinstallment DECIMAL(18,2), \n\ttotal_pymnt DECIMAL(18,2) , \n\tlast_pymnt_d VARCHAR(50), \n\tlast_pymnt_amnt DECIMAL(18,2), \n\tnext_pymnt_d VARCHAR(50), \n\tdisbursement_method VARCHAR(20)\n)\nWITH\n(\n    DISTRIBUTION = HASH (transaction_id),\n    CLUSTERED COLUMNSTORE INDEX\n)\nGO\n\n\n\nDROP TABLE [gold].[loan_defaulter_dim]\n CREATE TABLE [gold].[loan_defaulter_dim] (\n\tdefaulter_id VARCHAR(50),\n\tmember_id VARCHAR(50), \n\tdelinq_2yrs INT, \n\tinq_last_6mths INT,\n\tpub_rec INT,\n\ttotal_rec_late_fee INT,\n\tdelinq_amnt INT,\n\tpub_rec_bankruptcies INT, \n\thardship_flag VARCHAR(20), \n\thardship_type VARCHAR(50), \n\thardship_amount VARCHAR(20),\n\thardship_length VARCHAR(20)\n)\nWITH\n(\n    DISTRIBUTION = HASH (defaulter_id),\n    CLUSTERED COLUMNSTORE INDEX\n)\nGO\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "LC_DWH",
				"poolName": "LC_DWH"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}